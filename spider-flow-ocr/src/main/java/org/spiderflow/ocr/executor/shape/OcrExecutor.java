package org.spiderflow.ocr.executor.shape;

import java.util.Map;

import org.apache.commons.lang3.StringUtils;
import org.spiderflow.context.SpiderContext;
import org.spiderflow.executor.ShapeExecutor;
import org.spiderflow.model.Shape;
import org.spiderflow.model.SpiderNode;
import org.spiderflow.ocr.model.Ocr;
import org.springframework.stereotype.Component;

@Component
public class OcrExecutor implements ShapeExecutor{
	
	public static final String APP_ID = "appId";
	
	public static final String API_KEY = "apiKey";
	
	public static final String SECRET_KEY = "secretKey";
	
	public static final String OCR_CONTEXT_KEY = "$ocr_";
	
	@Override
	public String supportShape() {
		return "ocr";
	}
	
	@Override
	public Shape shape() {
		Shape shape = new Shape();
		shape.setImage("data:image/png;base64,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");
		shape.setLabel("OCR");
		shape.setName("ocr");
		shape.setTitle("OCR");
		return shape;
	}

	@Override
	public void execute(SpiderNode node, SpiderContext context, Map<String, Object> variables) {
		String appId = node.getStringJsonValue(APP_ID);
		String apiKey = node.getStringJsonValue(API_KEY);
		String secretKey = node.getStringJsonValue(SECRET_KEY);
		if (StringUtils.isBlank(appId)) {
			context.debug("appId不能为空！");
		} else if (StringUtils.isBlank(apiKey)) {
			context.debug("apiKey不能为空！");
		} else if (StringUtils.isBlank(secretKey)) {
			context.debug("secretKey不能为空！");
		} else {
			Ocr ocr = new Ocr(appId,apiKey,secretKey);
			context.put(OCR_CONTEXT_KEY + node.getNodeId(), ocr);
		}
	}

}
